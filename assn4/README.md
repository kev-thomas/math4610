# Assignment #4

## Task 1


## Task 2

### Code (`task2.py`):

```py
import numpy as np

# implementation
def est_second_derivative(f, x0, h):
    """
    Estimates the second derivative of function f at 
    point x0 using initial increment h.
    """
    return (f(x0 - h) - 2 * f(x0) + f(x0 - h))

# driver/testing code
if __name__ == '__main__':
    f = lambda x: ((x - (np.pi / 2)) * np.tan(x) ** 2) / (x ** 2 + 65)
    x0 = np.pi / 4
    h = 0.1
    for i in range(5):
        print(f'h: {h}  approximation: {est_second_derivative(f, x0, h)}')
        h *= h
```

### Output:

```shell
% python task2.py
h: 0.1  approximation: 0.005857179246311562
h: 0.010000000000000002  approximation: 0.0006403301696976636
h: 0.00010000000000000005  approximation: 6.46958531938871e-06
h: 1.0000000000000008e-08  approximation: 6.470261930402454e-10
h: 1.0000000000000017e-16  approximation: 6.938893903907228e-18
```


## Task 3

### Code (`task3.py`):

```py
import numpy as np
from task2 import est_second_derivative

# implementation
def linear_regression(x: list, y: list):
    """
    takes a list of x and y values and uses least squares method
    to perform linear regression.
    """
    n = len(x)
    m = [[n, 0],
         [0, 0]]
    o = [0, 0]

    for i in range(n):
        m[0][1] += x[i]
        m[1][0] += x[i]
        m[1][1] += x[i] ** 2
        o += y[i]
        o += x[i] * y[i]
    
    det = (m[0][0] * m[1][1]) - (m[0][1] * m[1][0])

    a = (m[1][1] / det) * o[0] + (-m[1][0] / det) * o[1]
    b = (-m[1][0] / det) * o[0] + (m[0][0] / det) * o[1]

    return a, b

# driver/testing code
if __name__ == '__main__':
    f = lambda x: ((x - (np.pi / 2)) * np.tan(x) ** 2) / (x ** 2 + 65)
    x0 = 1.0
    h = 0.00001
    x = []
    y = []
    for i in range(6):
        x.append(x0)
        y.append(est_second_derivative(f, x0, h))
        print(f'h: {x[i]}  approximation: {y[i]}')
        x0 += 0.1
    a, b = linear_regression(x, y)
    print(f'a: {a}  b: {b}')

```

### Output:

```shell
% python task3.py
h: 1.0  approximation: 1.0978150892723693e-06
h: 1.1  approximation: 1.5317236958453662e-06
h: 1.2000000000000002  approximation: 2.3547839400894777e-06
h: 1.3000000000000003  approximation: 4.243842565990197e-06
h: 1.4000000000000004  approximation: 1.0364062522416617e-05
h: 1.5000000000000004  approximation: 5.9338570883804564e-05
a: 0.00037792978003321266  b: -0.00027653398539015557
```


## Task 4

### Code (`task4.c`):

```c
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

double absError(double u, double v) {
    return u - v;
}

double relError(double u, double v) {
    return (u - v) / u;
}
```

### Compiling the shared library:

```shell
% gcc -c task4.c

% ar rcv errors.a task4.o
a - task4.o

% ranlib errors.a

% ar tv errors.a
rw-r--r-- 2883003748/40605028    804 Oct 17 20:22 2022 task4.o
```


## Task 5

### Code (`task5.py`):

```py
import numpy as np

# implementation
def explicit_euler(a, b, p0):
    """
    use explicit euler method on equation
    dP/dt = aP - BP^2
    """
    f = lambda p: (a * p) - b * (p ** 2)
    h = lambda t: (50 - t) / 50
    t0 = 0

    s = []

    for i in range(1, 50):
        t = t0 + h(t0)
        p = p0 + h(t0) * f(p0)

        s.append(p)

        p0 = p
        t0 = t
    
    return s

# driver code
if __name__ == '__main__':
    b = 0.0005
    p0 = 10.0

    print("Test 1")    
    a = 0.2
    print(explicit_euler(a, b, p0))
    print()

    print("Test 2") 
    a = 0.01
    print(explicit_euler(a, b, p0))
    print()

    print("Test 3")
    a = 2.0
    print(explicit_euler(a, b, p0))
```

### Output:

```shell
% python task5.py
Test 1
[11.95, 14.222226775, 16.85690120706414, 19.896295057186236, 23.384071360571333, 27.36440241203207, 31.88084784210477, 36.97498706222707, 42.684817220781795, 49.04294983560047, 56.07466574935972, 63.79591724546637, 72.211395104958, 81.31280294313984, 91.07749636438692, 101.46764521503582, 112.4300593262478, 123.8967796151111, 135.78647853122862, 148.00664177381046, 160.45642578963373, 173.03001400645005, 185.6202405111448, 198.12222211947397, 210.43674321359902, 222.47317142760454, 234.15173994054817, 245.40510368713367, 256.1791507070464, 266.4331156894138, 276.1390930500384, 285.2810779718411, 293.85367581853274, 301.86061609498324, 309.3131911624849, 316.2287171076545, 322.6290888897439, 328.5394775120436, 333.9871956589193, 339.000741108317, 343.60901452143906, 347.84069960866174, 351.7237885396354, 355.2852330528591, 358.5507012868871, 361.544421253112, 364.289093573698, 366.8058582204824, 369.1143022298624]

Test 2
[10.05, 10.098998775, 10.147014068676272, 10.194063497620741, 10.24016453713262, 10.285334508346587, 10.329590566614858, 10.372949691064203, 10.415428675252699, 10.457044118854515, 10.497812420304694, 10.537749770339211, 10.576872146369048, 10.615195307630222, 10.652734791054842, 10.689505907811355, 10.725523740464975, 10.760803140712177, 10.795358727645755, 10.829204886509554, 10.862355767904413, 10.894825287409208, 10.926627125583122, 10.957774728317354, 10.988281307506528, 11.018159842011954, 11.047423078890706, 11.076083534866184, 11.104153498017466, 11.13164502966627, 11.158569966441796, 11.184939922505066, 11.210766291915697, 
11.2360602511252, 11.260832761582078, 11.285094572435026, 11.308856223321586, 11.332128047230482, 11.354920173426825, 11.377242530430124, 11.399104849035872, 11.420516665372185, 11.441487323983626, 11.462025980935014, 11.482141606928595, 11.5018429904285, 
11.52113874078694, 11.54003729136706, 11.558546902657836]

Test 3
[29.95, 88.21246877499999, 253.91433147934794, 701.5381115906974, 1768.7165620323963, 3552.381877039811, 4256.675516090007, 3782.425315202107, 4132.497281916264, 3904.2402155377104, 4056.97939448872, 3964.4291716820167, 4019.75877470871, 3989.218777738598, 4005.4253405990803, 3997.400493083581, 4001.1610819366556, 3999.5134424343464, 4000.1898068605433, 3999.931189337867, 4000.0230648504994, 3999.9928840514717, 4000.0020091105803, 3999.999484270967, 4000.0001194224797, 3999.999975287966, 4000.000004517134, 
3999.9999992811654, 4000.0000000977275, 3999.999999988934, 4000.0000000010064, 3999.9999999999304, 4000.000000000003, 3999.9999999999995, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0]
```

![Output](./img/task5.png)